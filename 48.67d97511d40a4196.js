"use strict";(self.webpackChunkMyMoney=self.webpackChunkMyMoney||[]).push([[48],{6048:(V,_,s)=>{s.r(_),s.d(_,{DashboardModule:()=>K});var l=s(9808),O=s(1592),x=s(1083),p=s(7503),t=s(5e3),y=s(8480),v=s(8762),C=s(1271),b=s(6290),h=s(7093),A=s(2115),g=s(4623),M=s(4834),Z=s(7423);function T(n,o){if(1&n&&(t.TgZ(0,"mat-list-item",19),t._UZ(1,"img",20),t.TgZ(2,"div",21)(3,"span",22),t._uU(4),t.qZA()(),t.TgZ(5,"div",23)(6,"span",24),t._uU(7),t.ALo(8,"number"),t.qZA()()()),2&n){const e=o.$implicit,i=t.oxw(4);t.xp6(1),t.MGl("src","assets/categories/",e.category,".png",t.LSH),t.xp6(3),t.Oqu(e.category),t.xp6(3),t.AsE("",t.xi3(8,4,e.total,"1.0-3")," ","NONE"==i.userCurrency?"":i.userCurrency," ")}}function D(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"mat-list")(1,"div",15),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw(3).showDetails(r.month)}),t.TgZ(2,"span",16),t._uU(3),t.qZA(),t.TgZ(4,"span",17),t._uU(5),t.ALo(6,"number"),t.qZA()(),t._UZ(7,"mat-divider"),t.YNc(8,T,9,7,"mat-list-item",18),t.qZA()}if(2&n){const e=o.$implicit,i=t.oxw(3);t.xp6(3),t.hij("",e.month," "),t.xp6(2),t.AsE("",t.xi3(6,4,e.totalThisMonth,"1.0-3")," ","NONE"==i.userCurrency?"":i.userCurrency,""),t.xp6(3),t.Q6J("ngForOf",e.categories)}}function L(n,o){if(1&n&&(t.TgZ(0,"div",13),t.YNc(1,D,9,7,"mat-list",14),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.monthlyHistory)}}function F(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",4)(1,"div",5)(2,"div",6),t.NdJ("click",function(){return t.CHM(e),t.oxw().switchYear("-")}),t._UZ(3,"img",7),t.qZA(),t.TgZ(4,"div",8),t._uU(5),t.qZA(),t.TgZ(6,"div",6),t.NdJ("click",function(){return t.CHM(e),t.oxw().switchYear("+")}),t._UZ(7,"img",9),t.qZA()(),t.TgZ(8,"div",10),t._UZ(9,"apx-chart",11),t.qZA(),t.YNc(10,L,2,1,"div",12),t.qZA()}if(2&n){const e=t.oxw();t.xp6(5),t.hij(" ",e.year," "),t.xp6(4),t.Q6J("series",e.chartOptions.series)("chart",e.chartOptions.chart)("dataLabels",e.chartOptions.dataLabels)("plotOptions",e.chartOptions.plotOptions)("yaxis",e.chartOptions.yaxis)("xaxis",e.chartOptions.xaxis)("fill",e.chartOptions.fill),t.xp6(1),t.Q6J("ngIf",!e.isLoading)}}function N(n,o){1&n&&(t.TgZ(0,"div",25),t._UZ(1,"img",26),t.qZA())}function P(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",27)(1,"button",28),t.NdJ("click",function(){return t.CHM(e),t.oxw().reTry()}),t._uU(2,"Retry"),t.qZA()()}2&n&&(t.xp6(1),t.Q6J("color","primary"))}let w=(()=>{class n{constructor(e,i,c,r){this.transactionService=e,this.loginService=i,this.snackBar=c,this.router=r,this.data=[],this.monthlyHistory=[],this.userId=this.loginService.getSessionFromStorage(p.E1),this.userCurrency=this.loginService.getSessionFromStorage(p.tO),this.date=new Date,this.year=this.date.getFullYear().toString(),this.isLoading=!1,this.retry=!1}ngOnInit(){this.initData()}ngOnDestroy(){this.chartSubscription.unsubscribe()}initData(){this.getChartData(),this.getListData()}getChartData(){this.isLoading=!0,this.chartSubscription=this.transactionService.getYeearlyExpenses(this.year,this.userId).subscribe({next:e=>{this.data=e,this.isLoading=!1,this.initChart()},error:e=>{this.isLoading=!1,this.retry=!0,"404"==e.status?this.snackBar.open("Transaction not found","dismiss",{duration:3e3}):"502"==e.status?this.snackBar.open("Connection timed out, Try again later","dismiss",{duration:3e3}):(this.snackBar.open(e.message,"dismiss",{duration:3e3}),console.log("error =>"+e.message))}})}getListData(){this.isLoading=!0,this.listSubscription=this.transactionService.getTransactionByCategory(this.userId,this.year).subscribe({next:e=>{this.monthlyHistory=e,this.isLoading=!1},error:e=>{this.isLoading=!1,this.retry=!0,"404"==e.status?this.snackBar.open("Transaction not found","dismiss",{duration:3e3}):"502"==e.status?this.snackBar.open("Connection timed out, Try again later","dismiss",{duration:3e3}):(this.snackBar.open(e.message,"dismiss",{duration:3e3}),console.log("error =>"+e.message))}})}switchYear(e){"+"==e?(this.year=(Number(this.year)+1).toString(),this.initData()):"-"==e&&(this.year=(Number(this.year)-1).toString(),this.initData())}initChart(){this.chartOptions={series:[{name:"expenses",data:[Number(this.data[0].total.toFixed(3)),Number(this.data[1].total.toFixed(3)),Number(this.data[2].total.toFixed(3)),Number(this.data[3].total.toFixed(3)),Number(this.data[4].total.toFixed(3)),Number(this.data[5].total.toFixed(3)),Number(this.data[6].total.toFixed(3)),Number(this.data[7].total.toFixed(3)),Number(this.data[8].total.toFixed(3)),Number(this.data[9].total.toFixed(3)),Number(this.data[10].total.toFixed(3)),Number(this.data[11].total.toFixed(3))]}],chart:{height:250,type:"bar",toolbar:{tools:{download:!1}}},plotOptions:{bar:{dataLabels:{position:"top"}}},dataLabels:{enabled:!0,offsetY:-20,style:{fontSize:"12px",colors:["#304758"]}},xaxis:{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],position:"bottom",axisBorder:{show:!1},axisTicks:{show:!1},crosshairs:{fill:{type:"gradient",gradient:{colorFrom:"#D8E3F0",colorTo:"#BED1E6",stops:[0,100],opacityFrom:.4,opacityTo:.5}}}},fill:{type:"gradient"},yaxis:{axisBorder:{show:!1},axisTicks:{show:!1},labels:{show:!1}}}}showDetails(e){let i,c=e.slice(0,-5),r=e.slice(-4);switch(c){case"Jan":i=1;break;case"Feb":i=2;break;case"Mar":i=3;break;case"Apr":i=4;break;case"May":i=5;break;case"Jun":i=6;break;case"Jul":i=7;break;case"Aug":i=8;break;case"Sept":i=9;break;case"Oct":i=10;break;case"Nov":i=11;break;case"Dec":i=12}this.router.navigateByUrl("/dashboard/monthlyDetails/"+r+"/"+i)}reTry(){this.retry=!1,this.initData()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(y.v),t.Y36(v.r),t.Y36(C.ux),t.Y36(x.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-dashboard"]],decls:4,vars:5,consts:[[3,"title","Data"],["class","container","fxLayout","column",4,"ngIf"],["class","spinner min_height_90","fxLayoutAlign","center center",4,"ngIf"],["class","retry min_height_90","fxLayoutAlign","center center",4,"ngIf"],["fxLayout","column",1,"container"],["fxLayout","row",1,"year"],["fxFlex","",1,"arrow",3,"click"],["src","assets/last_year.png","alt","next_year"],["fxFlex","80","fxLayoutAlign","center center",1,"year"],["src","assets/next_year.png","alt","last_year"],[1,"chart"],[3,"series","chart","dataLabels","plotOptions","yaxis","xaxis","fill"],["class","history",4,"ngIf"],[1,"history"],[4,"ngFor","ngForOf"],["mat-subheader","",1,"list_title",3,"click"],["fxFlex","50","fxLayoutAlign","start",1,"date"],["fxFlex","50","fxLayoutAlign","end",1,"daily_total"],["class","list_item",4,"ngFor","ngForOf"],[1,"list_item"],["fxFlex","10",1,"category",3,"src"],["fxLayout","column","fxFlex","45","fxLayoutAlign","center start",1,"description"],[1,"name","font_weight_500"],["fxLayout","column","fxFlex","","fxLayoutAlign","center end",1,"value"],[1,"amount","font_weight_500"],["fxLayoutAlign","center center",1,"spinner","min_height_90"],["src","assets/loading.gif","alt","loading"],["fxLayoutAlign","center center",1,"retry","min_height_90"],["mat-flat-button","",3,"color","click"]],template:function(e,i){1&e&&(t._UZ(0,"app-header",0),t.YNc(1,F,11,9,"div",1),t.YNc(2,N,2,0,"div",2),t.YNc(3,P,3,1,"div",3)),2&e&&(t.Q6J("title","Dashboard")("Data",i.monthlyHistory),t.xp6(1),t.Q6J("ngIf",!i.isLoading&&!i.retry),t.xp6(1),t.Q6J("ngIf",i.isLoading),t.xp6(1),t.Q6J("ngIf",i.retry))},directives:[b.G,l.O5,h.xw,h.yH,h.Wh,A.x,l.sg,g.i$,g.gs,M.d,g.Tg,Z.lW],pipes:[l.JJ],styles:[".container[_ngcontent-%COMP%]{max-height:90%;min-width:350px;max-width:1000px;margin:auto;padding-bottom:5rem}.category[_ngcontent-%COMP%]{max-width:45px!important;max-height:45px}.arrow[_ngcontent-%COMP%]:hover{cursor:pointer}.year[_ngcontent-%COMP%]{font-weight:500;font-size:2rem}.history[_ngcontent-%COMP%]{padding-bottom:60px}.history[_ngcontent-%COMP%]   .category[_ngcontent-%COMP%]{margin:.5rem}.min_height_90[_ngcontent-%COMP%]{min-height:90%}.height_50[_ngcontent-%COMP%]{height:50%}.font_weight_500[_ngcontent-%COMP%]{font-weight:500}.color_A9A9A9[_ngcontent-%COMP%]{color:#a9a9a9}.mat-subheader[_ngcontent-%COMP%]{padding:0 1rem}mat-list-item[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}.list_title[_ngcontent-%COMP%]:active{background-color:#f0eaea;transition:background-color}.list_title[_ngcontent-%COMP%]:hover{background-color:#f2f2f2;transition:background-color;cursor:pointer}"]}),n})();var u=s(8505),S=s(9841),J=s(7272),E=s(9176),I=s(8966),U=s(9224),k=s(5245),Y=s(3322),H=s(4591);function B(n,o){1&n&&(t.TgZ(0,"mat-icon",14),t._uU(1,"arrow_upward"),t.qZA())}function Q(n,o){1&n&&(t.TgZ(0,"mat-icon",15),t._uU(1,"arrow_downward"),t.qZA())}const $=function(n){return{color:n}};function q(n,o){if(1&n&&(t.TgZ(0,"div",5)(1,"mat-card",6)(2,"p",7),t._uU(3),t.YNc(4,B,2,0,"mat-icon",8),t.YNc(5,Q,2,0,"mat-icon",9),t.TgZ(6,"span",10),t._uU(7),t.qZA()(),t.TgZ(8,"p",11)(9,"span"),t._uU(10),t.ALo(11,"number"),t.qZA(),t.TgZ(12,"span",12),t._UZ(13,"img",13),t.qZA()()()()),2&n){const e=t.oxw();t.xp6(3),t.AsE("Spent on ",e.monthName," ",e.year," "),t.xp6(1),t.Q6J("ngIf",e.expense_difference>0),t.xp6(1),t.Q6J("ngIf",e.expense_difference<0),t.xp6(1),t.Q6J("ngStyle",t.VKq(12,$,e.expense_difference>0?"red":"green")),t.xp6(1),t.AsE("",e.expense_difference," ",e.userCurrency,""),t.xp6(3),t.hij("",t.xi3(11,9,e.current_expense,"1.0-3")," "),t.xp6(3),t.MGl("src","assets/flags/",e.userCurrency,".png",t.LSH)}}function R(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"mat-list-item",22),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw(3).showDetails(r.id,r.category,r.description,r.amount,r.time)}),t._UZ(1,"img",23),t.TgZ(2,"div",24)(3,"span",25),t._uU(4),t.qZA(),t.TgZ(5,"span",26),t._uU(6),t.ALo(7,"description"),t.qZA()(),t.TgZ(8,"div",27)(9,"span",28),t._uU(10),t.ALo(11,"number"),t.qZA(),t.TgZ(12,"span",29),t._uU(13),t.qZA()()()}if(2&n){const e=o.$implicit,i=t.oxw(3);t.xp6(1),t.MGl("src","assets/categories/",e.category,".png",t.LSH),t.xp6(3),t.Oqu(e.category),t.xp6(2),t.Oqu(t.lcZ(7,6,e.description)),t.xp6(4),t.AsE("",t.xi3(11,8,e.amount,"1.0-3")," ","NONE"==i.userCurrency?"":i.userCurrency," "),t.xp6(3),t.Oqu(e.time)}}function z(n,o){if(1&n&&(t.TgZ(0,"mat-list")(1,"div",18)(2,"span",19),t._uU(3),t.ALo(4,"date"),t.qZA(),t.TgZ(5,"span",20),t._uU(6),t.ALo(7,"number"),t.qZA()(),t._UZ(8,"mat-divider"),t.YNc(9,R,14,11,"mat-list-item",21),t.qZA()),2&n){const e=o.$implicit,i=t.oxw(2);t.xp6(3),t.Oqu(t.xi3(4,4,e.date,"mediumDate")),t.xp6(3),t.AsE("",t.xi3(7,7,e.total,"1.0-3")," ","NONE"==i.userCurrency?"":i.userCurrency,""),t.xp6(3),t.Q6J("ngForOf",e.transactions)}}function j(n,o){if(1&n&&(t.TgZ(0,"div",16),t.YNc(1,z,10,10,"mat-list",17),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.dailyHistory)}}function G(n,o){1&n&&(t.TgZ(0,"div",30),t._UZ(1,"img",31),t.qZA())}const W=[{path:"",component:w},{path:"monthlyDetails/:year/:month",component:(()=>{class n{constructor(e,i,c,r,a){var m,d,f;this.activatedRoute=e,this.transService=i,this.loginService=c,this.snackBar=r,this.dialog=a,this.userId=this.loginService.getSessionFromStorage(p.E1),this.userCurrency=this.loginService.getSessionFromStorage(p.tO),this.dailyHistory=[],this.selectedItemIndex=0,this.isLoading=!1,this.retry=!1,this.month=Number(this.activatedRoute.snapshot.paramMap.get("month")),this.monthName=this.getMonthName(this.month),this.year=this.activatedRoute.snapshot.paramMap.get("year"),this.currentExpense$=this.transService.getCurrentMonthExpenseTotal(this.userId,this.year,null===(m=this.month)||void 0===m?void 0:m.toString()),this.lastExpense$=this.transService.getCurrentMonthExpenseTotal(this.userId,this.year,null===(d=this.month-1)||void 0===d?void 0:d.toString()),this.dailyHistory$=this.transService.getDailyTransaction(this.userId,this.year,null===(f=this.month)||void 0===f?void 0:f.toString()),this.current_expense=0,this.last_expense=0,this.expense_difference=0}ngOnInit(){this.activatedRoute.paramMap.subscribe(e=>{this.year=e.get("year"),this.month=Number(e.get("month")),this.getMonthlyExpensesData()})}showDetails(e,i,c,r,a){this.dialog.open(E.o,{data:{id:e,userId:this.userId,category:i,description:c,amount:r,time:a}}).afterClosed().subscribe(d=>{d&&this.getMonthlyExpensesData()})}getExpencesDifference(e,i){return i-e}getMonthlyExpensesData(){this.isLoading=!0;const e=this.currentExpense$.pipe((0,u.b)(a=>{this.current_expense=a})),i=this.lastExpense$.pipe((0,u.b)(a=>{this.last_expense=a})),c=(0,S.a)([e,i]).pipe((0,u.b)(([a,m])=>{const d=this.getExpencesDifference(m,a);this.expense_difference=Math.trunc(d)})),r=this.dailyHistory$.pipe((0,u.b)(a=>{this.dailyHistory=a}));this.Datasubscription=(0,J.z)(e,i,c,r).subscribe({complete:()=>{this.isLoading=!1},error:a=>{this.isLoading=!1,"404"==a.status?this.snackBar.open("Transaction not found","dismiss",{duration:3e3}):"502"==a.status?this.snackBar.open("Connection timed out, Try again later","dismiss",{duration:3e3}):(this.snackBar.open(a.message,"dismiss",{duration:3e3}),console.log("error =>"+a.message))}})}getMonthName(e){const i=new Date(0);return i.setUTCMonth(e-1),i.toLocaleString(void 0,{month:"long"})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(x.gz),t.Y36(y.v),t.Y36(v.r),t.Y36(C.ux),t.Y36(I.uw))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-monthly-details"]],decls:5,vars:4,consts:[[3,"title"],[1,"mobile"],["class","expense",4,"ngIf"],["class","history",4,"ngIf"],["class","spinner","fxLayoutAlign","center center",4,"ngIf"],[1,"expense"],["fxLayout","column","fxLayoutAlign","center center"],[1,"expense_title"],["style","color:red",4,"ngIf"],["style","color:green",4,"ngIf"],[3,"ngStyle"],["fxLayout","row","fxLayoutAlign","center center",1,"expense_value"],[1,"expense_flag"],[3,"src"],[2,"color","red"],[2,"color","green"],[1,"history"],[4,"ngFor","ngForOf"],["mat-subheader",""],["fxFlex","50","fxLayoutAlign","start",1,"date"],["fxFlex","50","fxLayoutAlign","end",1,"daily_total"],["class","list_item",3,"click",4,"ngFor","ngForOf"],[1,"list_item",3,"click"],["fxFlex","10",1,"category",3,"src"],["fxLayout","column","fxFlex","45","fxLayoutAlign","center start",1,"description"],[1,"name","font_weight_500"],[1,"desc","color_A9A9A9"],["fxLayout","column","fxFlex","","fxLayoutAlign","center end",1,"value"],[1,"amount","font_weight_500"],[1,"hour","color_A9A9A9"],["fxLayoutAlign","center center",1,"spinner"],["src","assets/loading.gif","alt","loading"]],template:function(e,i){1&e&&(t._UZ(0,"app-header",0),t.TgZ(1,"div",1),t.YNc(2,q,14,14,"div",2),t.YNc(3,j,2,1,"div",3),t.YNc(4,G,2,0,"div",4),t.qZA()),2&e&&(t.Q6J("title","Monthly History"),t.xp6(2),t.Q6J("ngIf",!i.isLoading),t.xp6(1),t.Q6J("ngIf",!i.isLoading),t.xp6(1),t.Q6J("ngIf",i.isLoading))},directives:[b.G,l.O5,U.a8,h.xw,h.Wh,k.Hw,l.PC,Y.Zl,l.sg,g.i$,g.gs,h.yH,M.d,g.Tg],pipes:[l.JJ,l.uU,H.O],styles:[".mobile[_ngcontent-%COMP%]{max-height:90%;min-width:350px;max-width:1000px;margin:auto;padding-bottom:5rem}.mobile[_ngcontent-%COMP%]   .category[_ngcontent-%COMP%]{max-width:45px!important;max-height:45px}.mobile[_ngcontent-%COMP%]   .expense[_ngcontent-%COMP%]{margin:1rem;min-width:20rem}.mobile[_ngcontent-%COMP%]   .expense[_ngcontent-%COMP%]   .expense_title[_ngcontent-%COMP%]{font-size:1rem}.mobile[_ngcontent-%COMP%]   .expense[_ngcontent-%COMP%]   .expense_title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:1rem;width:1rem;font-size:1rem}.mobile[_ngcontent-%COMP%]   .expense[_ngcontent-%COMP%]   .expense_value[_ngcontent-%COMP%]{font-weight:500;font-size:3rem}.mobile[_ngcontent-%COMP%]   .expense[_ngcontent-%COMP%]   .expense_flag[_ngcontent-%COMP%]{margin-left:1rem}.mobile[_ngcontent-%COMP%]   .history[_ngcontent-%COMP%]   .category[_ngcontent-%COMP%]{margin:.5rem}.mobile[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{margin:0;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.height_50[_ngcontent-%COMP%]{height:50%}.font_weight_500[_ngcontent-%COMP%]{font-weight:500}.color_A9A9A9[_ngcontent-%COMP%]{color:#a9a9a9}.mat-subheader[_ngcontent-%COMP%]{padding:0 1rem}mat-list-item[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}.list_item[_ngcontent-%COMP%]:active{background-color:#f2f2f2;transition:background-color}.list_item[_ngcontent-%COMP%]:hover{cursor:pointer}"]}),n})()}];let X=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[x.Bz.forChild(W)]]}),n})(),K=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[l.ez,X,O.m]]}),n})()}}]);